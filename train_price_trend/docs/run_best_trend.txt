Notes

The ranking prioritizes realised MTM ROI, then realised settlement ROI, then expected ROI, then expected profit.

To keep it fast, the grid defaults are modest; expand --edge-grid, add more bands, or more liquidity-levels as you like.

If your simulate_stream.py is missing book depth in snapshots, it falls back to LTP and disables liquidity automatically (it will still run and record that in the outputs).

# Use yesterday automatically
export CURATED_ROOT=/mnt/nvme/betfair-curated
/opt/BetfairBotML/train_price_trend/bin/run_best_trend.sh

# Explicit date + default TAG=automl
/opt/BetfairBotML/train_price_trend/bin/run_best_trend.sh 2025-09-26

# Explicit date + custom tag
/opt/BetfairBotML/train_price_trend/bin/run_best_trend.sh 2025-09-26 weekend_sweep


export CURATED_ROOT=/mnt/nvme/betfair-curated

# 1) AutoML sweep (trains once if needed)
python3 /opt/BetfairBotML/train_price_trend/ml/train_price_trend_automl.py \
  --curated $CURATED_ROOT \
  --asof 2025-09-26 \
  --start-date 2025-09-05 \
  --valid-days 7 \
  --sport horse-racing \
  --preoff-max 30 \
  --device cuda \
  --ev-mode mtm \
  --enforce-liquidity \
  --edge-grid 0.0005,0.001,0.0015,0.002,0.003 \
  --stake-grid flat,kelly \
  --odds-grid none,2.2:3.6,1.5:5.0 \
  --liquidity-levels-grid 1,3

# Artifacts:
#   /opt/BetfairBotML/train_price_trend/output/automl/2025-09-26/automl/trials_2025-09-26.csv
#   /opt/BetfairBotML/train_price_trend/output/automl/2025-09-26/automl/best_config.json

# 2) Re-run the best config (optional convenience)
/opt/BetfairBotML/train_price_trend/bin/run_best_trend.sh 2025-09-26 automl
